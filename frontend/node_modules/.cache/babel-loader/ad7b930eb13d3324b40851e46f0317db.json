{"ast":null,"code":"var _jsxFileName = \"E:\\\\education\\\\Phyton\\\\Projercts\\\\my_course_works\\\\course_3\\\\frontend\\\\src\\\\pages\\\\profile\\\\Profile.js\",\n    _s = $RefreshSig$();\n\nimport styles from \"./Profile.module.scss\";\nimport Header from \"../../components/header/Header\";\nimport Input from \"../../components/input/Input\";\nimport Button from \"../../components/button/Button\";\nimport { useEffect, useState } from \"react\";\nimport { getUser, updateUser, updateUserPassword } from \"../../api/user\";\nimport { tokenChecker } from \"../../utils/token\";\nimport { getGenres } from \"../../api/genres\";\nimport Select from \"../../components/select/Select\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Profile = () => {\n  _s();\n\n  const [name, setName] = useState(\"\");\n  const [surname, setSurname] = useState(\"\");\n  const [genre, setGenre] = useState(\"\");\n  const [genres, setGenres] = useState(\"\");\n  const [password, setPassword] = useState({\n    old: \"\",\n    new: \"\"\n  });\n  const [email, setEmail] = useState(\"\");\n  useEffect(() => {\n    getUser().then(res => profileUpdater(res.data)).catch(error => tokenChecker(error));\n    getGenres().then(res => setGenres(res.data)).catch(error => {\n      console.log(error.response);\n    });\n  }, []);\n  useEffect(() => {\n    console.log(genres);\n  }, [genres]);\n\n  const profileUpdater = data => {\n    setEmail(data.email || \"\");\n    setName(data.name || \"\");\n    setSurname(data.surname || \"\");\n    setGenre(data.favourite_genre || \"\");\n  };\n\n  const submitPasswordChange = () => {\n    updateUserPassword({\n      old_password: password.old,\n      new_password: password.new\n    }).then(res => {\n      alert('Пароль успешно изменен');\n      window.location = \"/\";\n    }).catch(error => {\n      alert(error.response.data.message);\n    });\n  };\n\n  const submitProfileUpdate = () => {\n    updateUser({ ...(name && {\n        name: name\n      }),\n      ...(surname && {\n        surname: surname\n      }),\n      ...(genre && {\n        favourite_genre: genre\n      })\n    }).then(res => {\n      profileUpdater(res.data);\n      window.location = \"/\";\n    }).catch(error => {\n      console.log(error.response);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.Profile,\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      title: \"\\u041C\\u043E\\u0439 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\",\n      subtitle: \"Sky movies\",\n      type: \"secondary\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.Profile__email,\n      children: email\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.Profile__form,\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        type: \"text\",\n        value: name,\n        placeholder: \"\\u0418\\u043C\\u044F\",\n        onChange: e => setName(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        type: \"text\",\n        value: surname,\n        placeholder: \"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\",\n        onChange: e => setSurname(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        options: genres,\n        selected: genre,\n        onChange: e => {\n          setGenre(e.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        label: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\",\n        onClick: submitProfileUpdate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.Profile__heading,\n        children: \"\\u0421\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        type: \"password\",\n        value: password.old,\n        placeholder: \"\\u0421\\u0442\\u0430\\u0440\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n        onChange: e => setPassword({\n          new: password.new,\n          old: e.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        type: \"password\",\n        value: password.new,\n        placeholder: \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n        onChange: e => setPassword({\n          new: e.target.value,\n          old: password.old\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        label: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\",\n        onClick: submitPasswordChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Profile, \"8FTB4MMpiqKlJfszTsO1oz/fRoI=\");\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["E:/education/Phyton/Projercts/my_course_works/course_3/frontend/src/pages/profile/Profile.js"],"names":["styles","Header","Input","Button","useEffect","useState","getUser","updateUser","updateUserPassword","tokenChecker","getGenres","Select","Profile","name","setName","surname","setSurname","genre","setGenre","genres","setGenres","password","setPassword","old","new","email","setEmail","then","res","profileUpdater","data","catch","error","console","log","response","favourite_genre","submitPasswordChange","old_password","new_password","alert","window","location","message","submitProfileUpdate","Profile__email","Profile__form","e","target","value","Profile__heading"],"mappings":";;;AAAA,OAAOA,MAAP,MAAmB,uBAAnB;AACA,OAAOC,MAAP,MAAmB,gCAAnB;AACA,OAAOC,KAAP,MAAkB,8BAAlB;AACA,OAAOC,MAAP,MAAmB,gCAAnB;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,OAAT,EAAkBC,UAAlB,EAA8BC,kBAA9B,QAAwD,gBAAxD;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,SAAT,QAA0B,kBAA1B;AACA,OAAOC,MAAP,MAAmB,gCAAnB;;AAEA,OAAO,MAAMC,OAAO,GAAG,MAAM;AAAA;;AAC3B,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBT,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACU,OAAD,EAAUC,UAAV,IAAwBX,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACY,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACc,MAAD,EAASC,SAAT,IAAsBf,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACgB,QAAD,EAAWC,WAAX,IAA0BjB,QAAQ,CAAC;AAACkB,IAAAA,GAAG,EAAE,EAAN;AAAUC,IAAAA,GAAG,EAAE;AAAf,GAAD,CAAxC;AACA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBrB,QAAQ,CAAC,EAAD,CAAlC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACdE,IAAAA,OAAO,GACJqB,IADH,CACQC,GAAG,IAAIC,cAAc,CAACD,GAAG,CAACE,IAAL,CAD7B,EAEGC,KAFH,CAESC,KAAK,IAAIvB,YAAY,CAACuB,KAAD,CAF9B;AAIAtB,IAAAA,SAAS,GACNiB,IADH,CACQC,GAAG,IAAIR,SAAS,CAACQ,GAAG,CAACE,IAAL,CADxB,EAEGC,KAFH,CAESC,KAAK,IAAI;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAK,CAACG,QAAlB;AACD,KAJH;AAKD,GAVQ,EAUN,EAVM,CAAT;AAYA/B,EAAAA,SAAS,CAAC,MAAM;AACd6B,IAAAA,OAAO,CAACC,GAAR,CAAYf,MAAZ;AACD,GAFQ,EAEN,CAACA,MAAD,CAFM,CAAT;;AAIA,QAAMU,cAAc,GAAIC,IAAD,IAAU;AAC/BJ,IAAAA,QAAQ,CAACI,IAAI,CAACL,KAAL,IAAc,EAAf,CAAR;AACAX,IAAAA,OAAO,CAACgB,IAAI,CAACjB,IAAL,IAAa,EAAd,CAAP;AACAG,IAAAA,UAAU,CAACc,IAAI,CAACf,OAAL,IAAgB,EAAjB,CAAV;AACAG,IAAAA,QAAQ,CAACY,IAAI,CAACM,eAAL,IAAwB,EAAzB,CAAR;AACD,GALD;;AAOA,QAAMC,oBAAoB,GAAG,MAAM;AACjC7B,IAAAA,kBAAkB,CAAE;AAAC8B,MAAAA,YAAY,EAAEjB,QAAQ,CAACE,GAAxB;AAA6BgB,MAAAA,YAAY,EAAElB,QAAQ,CAACG;AAApD,KAAF,CAAlB,CACGG,IADH,CACQC,GAAG,IAAI;AACXY,MAAAA,KAAK,CAAC,wBAAD,CAAL;AACAC,MAAAA,MAAM,CAACC,QAAP,GAAkB,GAAlB;AACD,KAJH,EAKGX,KALH,CAKSC,KAAK,IAAI;AACdQ,MAAAA,KAAK,CAACR,KAAK,CAACG,QAAN,CAAeL,IAAf,CAAoBa,OAArB,CAAL;AACD,KAPH;AAQD,GATD;;AAWA,QAAMC,mBAAmB,GAAG,MAAM;AAChCrC,IAAAA,UAAU,CAAC,EACT,IAAIM,IAAI,IAAI;AAACA,QAAAA,IAAI,EAAEA;AAAP,OAAZ,CADS;AAET,UAAIE,OAAO,IAAI;AAACA,QAAAA,OAAO,EAAEA;AAAV,OAAf,CAFS;AAGT,UAAIE,KAAK,IAAI;AAACmB,QAAAA,eAAe,EAAEnB;AAAlB,OAAb;AAHS,KAAD,CAAV,CAKGU,IALH,CAKQC,GAAG,IAAI;AACXC,MAAAA,cAAc,CAACD,GAAG,CAACE,IAAL,CAAd;AACAW,MAAAA,MAAM,CAACC,QAAP,GAAkB,GAAlB;AACD,KARH,EASGX,KATH,CASSC,KAAK,IAAI;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAK,CAACG,QAAlB;AACD,KAXH;AAYD,GAbD;;AAeA,sBACE;AAAK,IAAA,SAAS,EAAEnC,MAAM,CAACY,OAAvB;AAAA,4BAEE,QAAC,MAAD;AACE,MAAA,KAAK,EAAC,+DADR;AAEE,MAAA,QAAQ,EAAC,YAFX;AAGE,MAAA,IAAI,EAAC;AAHP;AAAA;AAAA;AAAA;AAAA,YAFF,eAOE;AAAK,MAAA,SAAS,EAAEZ,MAAM,CAAC6C,cAAvB;AAAA,gBAAwCpB;AAAxC;AAAA;AAAA;AAAA;AAAA,YAPF,eASE;AAAK,MAAA,SAAS,EAAEzB,MAAM,CAAC8C,aAAvB;AAAA,8BACE,QAAC,KAAD;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,KAAK,EAAEjC,IAFT;AAGE,QAAA,WAAW,EAAC,oBAHd;AAIE,QAAA,QAAQ,EAAGkC,CAAD,IAAOjC,OAAO,CAACiC,CAAC,CAACC,MAAF,CAASC,KAAV;AAJ1B;AAAA;AAAA;AAAA;AAAA,cADF,eAOE,QAAC,KAAD;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,KAAK,EAAElC,OAFT;AAGE,QAAA,WAAW,EAAC,4CAHd;AAIE,QAAA,QAAQ,EAAGgC,CAAD,IAAO/B,UAAU,CAAC+B,CAAC,CAACC,MAAF,CAASC,KAAV;AAJ7B;AAAA;AAAA;AAAA;AAAA,cAPF,eAcE,QAAC,MAAD;AACE,QAAA,OAAO,EAAE9B,MADX;AAEE,QAAA,QAAQ,EAAEF,KAFZ;AAGE,QAAA,QAAQ,EAAG8B,CAAD,IAAO;AACf7B,UAAAA,QAAQ,CAAC6B,CAAC,CAACC,MAAF,CAASC,KAAV,CAAR;AACD;AALH;AAAA;AAAA;AAAA;AAAA,cAdF,eAsBE,QAAC,MAAD;AACE,QAAA,KAAK,EAAC,wDADR;AAEE,QAAA,OAAO,EAAEL;AAFX;AAAA;AAAA;AAAA;AAAA,cAtBF,eA2BE;AAAK,QAAA,SAAS,EAAE5C,MAAM,CAACkD,gBAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA3BF,eA6BE,QAAC,KAAD;AACE,QAAA,IAAI,EAAC,UADP;AAEE,QAAA,KAAK,EAAE7B,QAAQ,CAACE,GAFlB;AAGE,QAAA,WAAW,EAAC,2EAHd;AAIE,QAAA,QAAQ,EAAGwB,CAAD,IAAOzB,WAAW,CAAC;AAACE,UAAAA,GAAG,EAAEH,QAAQ,CAACG,GAAf;AAAoBD,UAAAA,GAAG,EAAEwB,CAAC,CAACC,MAAF,CAASC;AAAlC,SAAD;AAJ9B;AAAA;AAAA;AAAA;AAAA,cA7BF,eAoCE,QAAC,KAAD;AACE,QAAA,IAAI,EAAC,UADP;AAEE,QAAA,KAAK,EAAE5B,QAAQ,CAACG,GAFlB;AAGE,QAAA,WAAW,EAAC,qEAHd;AAIE,QAAA,QAAQ,EAAGuB,CAAD,IAAOzB,WAAW,CAAC;AAACE,UAAAA,GAAG,EAAEuB,CAAC,CAACC,MAAF,CAASC,KAAf;AAAsB1B,UAAAA,GAAG,EAAEF,QAAQ,CAACE;AAApC,SAAD;AAJ9B;AAAA;AAAA;AAAA;AAAA,cApCF,eA2CE,QAAC,MAAD;AACE,QAAA,KAAK,EAAC,wDADR;AAEE,QAAA,OAAO,EAAEc;AAFX;AAAA;AAAA;AAAA;AAAA,cA3CF;AAAA;AAAA;AAAA;AAAA;AAAA,YATF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA4DD,CArHM;;GAAMzB,O;;KAAAA,O;AAuHb,eAAeA,OAAf","sourcesContent":["import styles from \"./Profile.module.scss\";\r\nimport Header from \"../../components/header/Header\";\r\nimport Input from \"../../components/input/Input\";\r\nimport Button from \"../../components/button/Button\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getUser, updateUser, updateUserPassword } from \"../../api/user\";\r\nimport { tokenChecker } from \"../../utils/token\";\r\nimport { getGenres } from \"../../api/genres\";\r\nimport Select from \"../../components/select/Select\";\r\n\r\nexport const Profile = () => {\r\n  const [name, setName] = useState(\"\");\r\n  const [surname, setSurname] = useState(\"\");\r\n  const [genre, setGenre] = useState(\"\");\r\n  const [genres, setGenres] = useState(\"\");\r\n  const [password, setPassword] = useState({old: \"\", new: \"\"});\r\n  const [email, setEmail] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    getUser()\r\n      .then(res => profileUpdater(res.data))\r\n      .catch(error => tokenChecker(error));\r\n\r\n    getGenres()\r\n      .then(res => setGenres(res.data))\r\n      .catch(error => {\r\n        console.log(error.response);\r\n      });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log(genres);\r\n  }, [genres])\r\n\r\n  const profileUpdater = (data) => {\r\n    setEmail(data.email || \"\");\r\n    setName(data.name || \"\");\r\n    setSurname(data.surname || \"\");\r\n    setGenre(data.favourite_genre || \"\");\r\n  };\r\n\r\n  const submitPasswordChange = () => {\r\n    updateUserPassword( {old_password: password.old, new_password: password.new})\r\n      .then(res => {\r\n        alert('Пароль успешно изменен');\r\n        window.location = \"/\";\r\n      })\r\n      .catch(error => {\r\n        alert(error.response.data.message);\r\n      })\r\n  };\r\n\r\n  const submitProfileUpdate = () => {\r\n    updateUser({\r\n      ...(name && {name: name}),\r\n      ...(surname && {surname: surname}),\r\n      ...(genre && {favourite_genre: genre}),\r\n    })\r\n      .then(res => {\r\n        profileUpdater(res.data);\r\n        window.location = \"/\";\r\n      })\r\n      .catch(error => {\r\n        console.log(error.response)\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className={styles.Profile}>\r\n\r\n      <Header\r\n        title=\"Мой профиль\"\r\n        subtitle=\"Sky movies\"\r\n        type=\"secondary\"\r\n      />\r\n      <div className={styles.Profile__email}>{email}</div>\r\n\r\n      <div className={styles.Profile__form}>\r\n        <Input\r\n          type=\"text\"\r\n          value={name}\r\n          placeholder=\"Имя\"\r\n          onChange={(e) => setName(e.target.value)}\r\n        />\r\n        <Input\r\n          type=\"text\"\r\n          value={surname}\r\n          placeholder=\"Фамилия\"\r\n          onChange={(e) => setSurname(e.target.value)}\r\n        />\r\n\r\n        <Select\r\n          options={genres}\r\n          selected={genre}\r\n          onChange={(e) => {\r\n            setGenre(e.target.value)\r\n          }}\r\n        />\r\n\r\n        <Button\r\n          label=\"Сохранить\"\r\n          onClick={submitProfileUpdate}\r\n        />\r\n\r\n        <div className={styles.Profile__heading}>Сменить пароль</div>\r\n\r\n        <Input\r\n          type=\"password\"\r\n          value={password.old}\r\n          placeholder=\"Старый пароль\"\r\n          onChange={(e) => setPassword({new: password.new, old: e.target.value})}\r\n        />\r\n\r\n        <Input\r\n          type=\"password\"\r\n          value={password.new}\r\n          placeholder=\"Новый пароль\"\r\n          onChange={(e) => setPassword({new: e.target.value, old: password.old})}\r\n        />\r\n\r\n        <Button\r\n          label=\"Сохранить\"\r\n          onClick={submitPasswordChange}\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Profile;"]},"metadata":{},"sourceType":"module"}